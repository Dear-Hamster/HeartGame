/* Custom 3D & Utility Classes */
body {
  background: linear-gradient(135deg, #fff0f3 0%, #ffe5ec 100%);
  overflow-x: hidden;
  /* Prevent horizontal scrolling on mobile */
}

.stage {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  min-height: 100vh;
  /* Use min-height for content that might push down */
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  opacity: 0;
  visibility: hidden;
  padding: 1rem;
  perspective: 1000px;
}

.stage.active {
  opacity: 1;
  visibility: visible;
  z-index: 10;
}

/* Glassmorphism Card */
.glass-card {
  background: rgba(255, 255, 255, 0.85);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.5);
  /* Responsive width adjustments for cards */
  width: 100%;
  max-width: 90%;
  /* Default for mobile */
}

@media (min-width: 640px) {
  .glass-card {
    max-width: 28rem;
    /* sm:max-w-md (448px) */
  }
}

/* 3D Presets */
.preserve-3d {
  transform-style: preserve-3d;
}

/* Game Canvas Container - For responsive square aspect ratio */
#gameCanvasContainer {
  width: 100%;
  padding-top: 100%;
  /* 1:1 Aspect Ratio */
  position: relative;
}

#gameCanvas {
  position: absolute;
  top: 0;
  left: 0;
  display: block;
  width: 100%;
  height: 100%;
}

/* Envelope 3D Construction - Adjusted for responsiveness */
.envelope-3d-container {
  perspective: 1000px;
  width: 80vw;
  /* Fluid width */
  max-width: 350px;
  /* Cap size */
  height: calc(80vw * 2 / 3);
  /* Maintain aspect ratio */
  max-height: 233px;
  cursor: pointer;
}

.envelope-body {
  width: 100%;
  height: 100%;
  background: #ff4d6d;
  position: absolute;
  border-radius: 0 0 8px 8px;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
  z-index: 10;
  overflow: hidden;
}

.envelope-flap {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: #ff758f;
  clip-path: polygon(0 0, 100% 0, 50% 60%);
  transform-origin: top;
  transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  z-index: 20;
}

.envelope-pocket {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: #ff5c8a;
  clip-path: polygon(0 100%, 50% 40%, 100% 100%);
  z-index: 15;
}

.letter-preview {
  position: absolute;
  top: 5%;
  /* Responsive positioning */
  left: 5%;
  width: 90%;
  height: 80%;
  background: white;
  z-index: 5;
  transition: transform 0.5s ease;
  padding: 20px;
}

/* Code Editor */
.code-editor {
  background: #1e1e1e;
  color: #d4d4d4;
  font-family: "Fira Code", monospace;
}

/* Floating Hearts Parallax */
.parallax-heart {
  position: fixed;
  pointer-events: none;
  z-index: 0;
  opacity: 0.6;
}

/* Chuss Popup */
#chussPopup {
  z-index: 9999;
  pointer-events: none;
}

.spark {
  position: absolute;
  width: 6px;
  height: 6px;
  background: gold;
  border-radius: 50%;
  z-index: 50;
  pointer-events: none;
}
/* --- D-Pad Base Styling --- */
#mobileControls {
  display: none; /* hidden by default (desktop) */
  width: 180px;
  height: 180px;
  margin-top: 20px;

  /* D-pad grid layout */
  display: grid;
  grid-template-areas:
      ". up ."
      "left center right"
      ". down .";
}

/* --- Buttons --- */
#mobileControls button {
  background-color: #ff8fa3;
  color: white;
  padding: 15px;
  border-radius: 10px;
  font-size: 1.25rem;
  transition: all 0.1s ease-out;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

#mobileControls button:active {
  transform: scale(0.95);
  background-color: #ff4d6d;
  box-shadow: 0 2px 3px rgba(0, 0, 0, 0.2);
}

/* --- Grid Areas --- */
#upBtn    { grid-area: up; }
#downBtn  { grid-area: down; }
#leftBtn  { grid-area: left; }
#rightBtn { grid-area: right; }
.dpad-center {
  grid-area: center;
  visibility: hidden;
}
/* Hide by default (desktop) */
#mobileControls {
  display: none;
}

/* --- Show only on mobile + tablets --- */
@media (max-width: 1024px) {
  #mobileControls {
    display: grid;
  }
}

/* ===========================
            Music POP
        ====================== */
/* Popup Overlay */
.music-popup {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.55);
  backdrop-filter: blur(4px);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;

  opacity: 1;
  transition: opacity 0.6s ease;
}

.music-popup.hide {
  opacity: 0;
  pointer-events: none;
}

/* Popup Box */
.music-box {
  background: white;
  width: 320px;
  padding: 25px;
  border-radius: 18px;
  text-align: center;
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
  animation: pop 0.55s ease;
}

@keyframes pop {
  0% {
    transform: scale(0.7);
    opacity: 0;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

.play-btn {
  background: #6a5acd;
  color: white;
  padding: 12px 25px;
  border: none;
  border-radius: 30px;
  cursor: pointer;
  font-size: 16px;
  margin-top: 15px;
  transition: 0.25s ease;
}

.play-btn:hover {
  background: #5849c2;
  transform: scale(1.05);
}
